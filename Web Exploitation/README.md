# Web Exploitation

This section was attempted during the CTF, but none of the flags were solved during the actual event. Overall, web exploitation is a very weak space for NilbinSec but with the added time after Defcon a little bit was learned. The ones that have been solved so far were very satisfying because it was a novel experience.

# Login via Blind SQL Injection
**Point Value:** 10

**Prompt**
_Agent, since the fall of the Mad Hatter, his agents have been scrambling to stay organized. We have identified one of their main communications channels. It is a web-based messaging system located at https://mail.themadhatters.xyz/ At this point, we have limited information about this system, and need you to try to gain access to it. You might want to try a Blind SQL Injection to get past the login page._

_SQL Inject your way into https://mail.themadhatters.xyz/_

Flag: **DCDNKYBCJGJJNB**

**Methodology**
During the CTF, no articles were found that could actually describe how to execute a Blind SQL Injection or the basis for building one. After Defcon, the following [video](https://www.youtube.com/watch?v=cx6Xs3F_1Uc&t=626s) was crucial to understanding the exploit. Attempting to login with username: admin, and password: ' OR '1'='1' provided access to the FiveofHearts account. That this gave access to the FiveOfHearts account and not an admin account makes me think the server is actually program to respond specifically to the SQL injection above and that this was not an actual exploit of the SQL database. This is understandable but will become more apparent why in the next flag.

# Cross-Site Request Forgery
**Point Value:** 10

**Prompt**
_Hmm... there's not much here except a new recruit receiving requests from their superior. Next thing we should do is try to access that account. When I put in their username, it pops up with 2-Factor Authentication. So we'll have to deal with that first. See if you can send a Cross-Site Request Forgery to QueenOfHearts, and trick them into turning it off. I wrote up a draft message and saved it, just add your CSRF link to that and send it._

_Use CSRF to trick QueenOfHearts into disabling 2-Factor Authentication on https://mail.themadhatters.xyz/_

Flag: **DCDNEWYACGRGKD**

**Methodology**
This flag was frustrating. There is a direct link to disable 2FA, trying to send the link as is to the Queen resulted in an angry email. Similar results happened when the same link (https://mail.themadhatters.xyz/?2fa=off&s=1) was obfuscated with a the rb.gy link shortener. The specific requirement that triggered the flag was _System Message.  Everyone must click link below to update your software:  < a href="https://mail.themadhatters.xyz/?2fa=off&s=1">Update Here< /a>_. While this makes similar sense, the URL shortener solution feels more elegant from an obfuscation/stealth standpoint than just hiding the 2FA link in HTML tags. Especially because HTML formatting may not be active on the target's webmail/mail program.
